"use strict";var _require=require("express"),Router=_require.Router,router=Router(),_require2=require("mongodb"),MongoClient=_require2.MongoClient,ObjectID=_require2.ObjectID,ObjectId=_require2.ObjectId,chalk=require("chalk"),client=new MongoClient("mongodb+srv://admin-app-todo1:admin-app-todo1@cluster0.7h1fx.mongodb.net/app-todo?retryWrites=true&w=majority",{useUnifiedTopology:!0});router.get("/",function(e,t){var r,n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(client.connect());case 3:return r=client.db().collection("todos"),e.next=6,regeneratorRuntime.awrap(r.find().toArray());case 6:return n=e.sent,e.next=9,regeneratorRuntime.awrap(t.render("index",{arr:n}));case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(chalk.red(e.t0));case 14:case"end":return e.stop()}},null,null,[[0,11]])}),router.post("/changeTodo",function(t,r){var n,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(client.connect());case 3:return n=client.db().collection("todos"),e.next=6,regeneratorRuntime.awrap(n.updateOne({title:t.body.title,text:t.body.text},{$set:{title:t.body.changeTitle,text:t.body.changeText}}));case 6:return e.next=8,regeneratorRuntime.awrap(n.find().toArray());case 8:return o=e.sent,e.next=11,regeneratorRuntime.awrap(r.render("index",{arr:o}));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(chalk.red(e.t0));case 16:case"end":return e.stop()}},null,null,[[0,13]])}),router.post("/deleteTodo",function(t,r){var n,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(e){return"empty"==e?"empty":e},e.next=3,regeneratorRuntime.awrap(client.connect());case 3:return n=client.db().collection("todos"),e.next=6,regeneratorRuntime.awrap(n.deleteOne({title:t.body.title,text:o(t.body.text)}));case 6:return e.next=8,regeneratorRuntime.awrap(r.redirect("/"));case 8:case"end":return e.stop()}})}),router.get("/create",function(e,t){t.render("create",{})}),router.post("/createTodo",function(t,r){var n,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(e){return""==e?"empty":e},e.next=3,regeneratorRuntime.awrap(client.connect());case 3:return n=client.db().collection("todos"),e.next=6,regeneratorRuntime.awrap(n.insertOne({title:t.body.title,text:o(t.body.text)}));case 6:return e.next=8,regeneratorRuntime.awrap(r.redirect("/"));case 8:case"end":return e.stop()}})}),module.exports=router;